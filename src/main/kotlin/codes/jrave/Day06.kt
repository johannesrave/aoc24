package codes.jrave

import codes.jrave.Direction.Companion.guardMarkers
import java.io.File
import kotlin.system.measureTimeMillis

fun main() {
  val day06ATest = Day06A("input/test_06")
  val day06ATestResult = day06ATest.solve().also { println(it) }
  assert(day06ATestResult == 41)

  val day06A = Day06A("input/input_06")
  val durationA = measureTimeMillis {
    val solution = day06A.solve()
    println("Solution for Day06A: $solution")
    assert(solution == 4665)
  }
  println("Solution took $durationA milliseconds")

  val day06BTest = Day06B("input/test_06")
  val day06BTestResult = day06BTest.solve()
  println("Test result for Day06B: $day06BTestResult")
  assert(day06BTestResult == 6)

  val day06B = Day06B("input/input_06")
  val duration06B = measureTimeMillis {
    val solution = day06B.solve()
    println("Solution for Day06B: $solution")
    assert(solution > 1511)
    assert(solution > 1660)
    assert(solution > 1661)
    assert(solution > 1662)
    assert(solution != 1846)
  }
  println("Solution took $duration06B milliseconds")
}


data class Day06A(
  val inputPath: String, val input: String = File(inputPath).readText(Charsets.UTF_8)
) {
  fun solve(input: String = this.input): Int {
    val board = parseBoard(input)

    val guardPosition = board.findPosition(guardMarkers)
    val guardMarker = board[guardPosition]
    val direction = Direction.from(guardMarker)

    val positions = walkPath(guardPosition, direction, board)

    return positions.size
  }

  private fun walkPath(
    guardPosition: Pos, direction: Direction, board: Array<CharArray>, block: Char = '#'
  ): MutableSet<Pos> {
    var guardPosition1 = guardPosition
    var guardDirection1 = direction
    val positions = mutableSetOf(guardPosition1)

    while (true) {
      val lookAheadPos = guardPosition1 + guardDirection1
      guardDirection1 = when {
        !(board contains lookAheadPos) -> break
        (board[lookAheadPos] == block) -> guardDirection1.turnClockwise()
        else -> guardDirection1
      }
      guardPosition1 += guardDirection1
      positions += guardPosition1
    }
    return positions
  }
}

data class Day06B(
  val inputPath: String, val input: String = File(inputPath).readText(Charsets.UTF_8)
) {
  fun solve(input: String = this.input): Int {
    val board = parseBoard(input)
    val blockChar = '#'

    val guardPosition = board.findPosition(guardMarkers)
    val guardMarker = board[guardPosition]
    val direction = Direction.from(guardMarker)

    val (path, _) = walkPath(board, guardPosition, direction, blockChar)

//    println(board.markSteps(path).toPrintString())

    val obstructionsIncludingDuplicates = path
      .map { step ->
        val blockPos = step.pos + step.dir
        step to blockPos
      }
      .distinctBy { (_, blockPos) -> blockPos }
      .filter { (step, blockPos) ->
        if (blockPos !in board) return@filter false
        if (blockPos == guardPosition) return@filter false

        val blockedBoard = board.deepClone().apply { set(blockPos, blockChar) }
        val (path, isCyclical) = walkPath(blockedBoard, step.pos, step.dir)
        (isCyclical)
      }.map { (_, blockPos) -> blockPos }.also { println(it.size) }

    val obstructionPositions = obstructionsIncludingDuplicates.distinct().also { println(it.size) }

    val wrongPositions = obstructionPositions.filter { it !in solution }
    val missingPositions = solution.filter { it !in obstructionPositions }

    println()
    val markedBoard = board.markSteps(path).markPositions(obstructionPositions)
    println("obstructions O")
    println(markedBoard.toPrintString())

    if (board.size > 50) {
      println()
      println("obstructions O, wrong @ and missing T")
      println(
        board
          .markSteps(path)
          .markPositions(obstructionPositions, char = 'O')
          .markPositions(wrongPositions, char = '@')
          .markPositions(missingPositions, char = 'T').toPrintString()
      )
    }
    return obstructionPositions.size
  }

  private fun walkPath(
    board: Array<CharArray>,
    pos: Pos,
    dir: Direction,
    block: Char = '#'
  ): Pair<MutableList<Step>, Boolean> {
    val steps = mutableListOf(Step(pos, dir))

    while (true) {
      var (pos, dir) = steps.last()
      val lookAheadPos = pos + dir

      if (!(board contains lookAheadPos)) return steps to false
      when {
        (board[lookAheadPos] == block) -> dir = dir.turnClockwise()
        else -> pos += dir
      }

      val step = Step(pos, dir)
      if (step in steps) {
        return steps to true
      }
      steps.addLast(step)
    }
  }

  fun Array<CharArray>.markPositions(positions: List<Pos>, char: Char = 'O'): Array<CharArray> =
    deepClone().also { board -> positions.forEach { pos -> board[pos] = char } }


  fun Array<CharArray>.markSteps(steps: List<Step>, overrideChar: Char? = null): Array<CharArray> {
    val board_ = deepClone()
    steps.forEach { step -> board_[step.pos] = overrideChar ?: step.dir.c }
    board_[steps.first().pos] = 'X'
    return board_
  }

  private operator fun Pos.plus(direction: Direction): Pos =
    Pos(y + direction.y, x + direction.x)
}

data class Step(val pos: Pos, val dir: Direction)

enum class Direction(val x: Int, val y: Int, val c: Char) {
  N(0, -1, '^'), E(1, 0, '>'), S(0, 1, 'v'), W(-1, 0, '<'), ;

  fun turnClockwise() = turnBy(1)

  private fun turnBy(n: Int) = entries[(this.ordinal + n) % entries.size]

  companion object {
    val guardMarkers = entries.map { it.c }.toSet()
    fun from(c: Char): Direction = entries.find { it.c == c }!!
  }
}

val solution = """
obstacle: 6 16
obstacle: 6 18
obstacle: 6 20
obstacle: 6 24
obstacle: 6 27
obstacle: 6 33
obstacle: 6 35
obstacle: 8 36
obstacle: 9 5
obstacle: 9 36
obstacle: 10 16
obstacle: 10 36
obstacle: 12 36
obstacle: 12 92
obstacle: 12 95
obstacle: 12 96
obstacle: 12 97
obstacle: 12 98
obstacle: 12 99
obstacle: 12 100
obstacle: 12 102
obstacle: 12 103
obstacle: 12 107
obstacle: 12 112
obstacle: 13 5
obstacle: 13 16
obstacle: 13 23
obstacle: 13 27
obstacle: 13 40
obstacle: 13 42
obstacle: 13 43
obstacle: 13 47
obstacle: 13 48
obstacle: 13 49
obstacle: 13 53
obstacle: 13 64
obstacle: 13 68
obstacle: 13 70
obstacle: 13 71
obstacle: 13 72
obstacle: 13 73
obstacle: 13 74
obstacle: 13 75
obstacle: 13 76
obstacle: 13 77
obstacle: 13 78
obstacle: 13 79
obstacle: 13 81
obstacle: 13 82
obstacle: 13 83
obstacle: 13 84
obstacle: 13 85
obstacle: 13 87
obstacle: 13 89
obstacle: 13 90
obstacle: 13 92
obstacle: 13 112
obstacle: 14 5
obstacle: 14 7
obstacle: 14 14
obstacle: 14 92
obstacle: 15 5
obstacle: 15 36
obstacle: 15 92
obstacle: 15 94
obstacle: 16 68
obstacle: 16 70
obstacle: 16 75
obstacle: 16 76
obstacle: 16 77
obstacle: 16 78
obstacle: 16 79
obstacle: 16 81
obstacle: 16 83
obstacle: 16 85
obstacle: 16 88
obstacle: 16 90
obstacle: 16 92
obstacle: 16 96
obstacle: 16 98
obstacle: 16 99
obstacle: 16 100
obstacle: 17 5
obstacle: 17 7
obstacle: 17 14
obstacle: 17 94
obstacle: 17 101
obstacle: 17 105
obstacle: 17 107
obstacle: 17 113
obstacle: 17 118
obstacle: 17 121
obstacle: 17 122
obstacle: 18 94
obstacle: 18 101
obstacle: 18 112
obstacle: 18 122
obstacle: 19 5
obstacle: 19 7
obstacle: 19 41
obstacle: 19 42
obstacle: 19 44
obstacle: 19 45
obstacle: 19 46
obstacle: 19 47
obstacle: 19 50
obstacle: 19 51
obstacle: 19 53
obstacle: 19 64
obstacle: 19 65
obstacle: 20 5
obstacle: 20 19
obstacle: 20 40
obstacle: 20 94
obstacle: 20 112
obstacle: 20 122
obstacle: 21 5
obstacle: 21 7
obstacle: 21 9
obstacle: 21 10
obstacle: 21 14
obstacle: 21 40
obstacle: 21 66
obstacle: 22 5
obstacle: 22 9
obstacle: 22 12
obstacle: 22 13
obstacle: 22 23
obstacle: 22 27
obstacle: 22 40
obstacle: 22 42
obstacle: 22 47
obstacle: 22 48
obstacle: 22 66
obstacle: 22 92
obstacle: 22 94
obstacle: 22 101
obstacle: 22 112
obstacle: 22 122
obstacle: 23 40
obstacle: 23 48
obstacle: 23 92
obstacle: 24 5
obstacle: 24 9
obstacle: 24 11
obstacle: 24 19
obstacle: 24 40
obstacle: 24 47
obstacle: 24 59
obstacle: 24 92
obstacle: 24 94
obstacle: 24 101
obstacle: 24 104
obstacle: 25 5
obstacle: 25 7
obstacle: 25 9
obstacle: 25 40
obstacle: 25 94
obstacle: 25 98
obstacle: 25 99
obstacle: 25 100
obstacle: 26 9
obstacle: 26 36
obstacle: 26 40
obstacle: 26 48
obstacle: 26 52
obstacle: 26 104
obstacle: 26 122
obstacle: 27 9
obstacle: 27 12
obstacle: 27 14
obstacle: 27 40
obstacle: 28 5
obstacle: 28 7
obstacle: 28 9
obstacle: 28 11
obstacle: 28 12
obstacle: 28 19
obstacle: 28 40
obstacle: 28 52
obstacle: 28 66
obstacle: 28 94
obstacle: 28 101
obstacle: 29 6
obstacle: 29 8
obstacle: 29 9
obstacle: 29 10
obstacle: 29 11
obstacle: 29 17
obstacle: 29 18
obstacle: 29 20
obstacle: 29 25
obstacle: 29 27
obstacle: 29 30
obstacle: 29 32
obstacle: 29 34
obstacle: 29 41
obstacle: 29 42
obstacle: 29 46
obstacle: 29 47
obstacle: 29 52
obstacle: 29 66
obstacle: 29 112
obstacle: 29 122
obstacle: 30 19
obstacle: 30 36
obstacle: 30 40
obstacle: 30 48
obstacle: 30 66
obstacle: 30 92
obstacle: 30 95
obstacle: 31 9
obstacle: 31 19
obstacle: 31 40
obstacle: 31 51
obstacle: 31 53
obstacle: 31 57
obstacle: 31 58
obstacle: 31 62
obstacle: 31 65
obstacle: 31 66
obstacle: 31 70
obstacle: 31 71
obstacle: 31 72
obstacle: 31 73
obstacle: 31 76
obstacle: 31 122
obstacle: 32 7
obstacle: 32 9
obstacle: 32 36
obstacle: 32 40
obstacle: 32 66
obstacle: 32 94
obstacle: 32 104
obstacle: 33 19
obstacle: 33 22
obstacle: 33 23
obstacle: 33 25
obstacle: 33 30
obstacle: 33 32
obstacle: 33 33
obstacle: 33 34
obstacle: 33 38
obstacle: 33 39
obstacle: 33 40
obstacle: 33 42
obstacle: 33 45
obstacle: 33 46
obstacle: 33 47
obstacle: 33 92
obstacle: 33 104
obstacle: 34 21
obstacle: 34 40
obstacle: 34 66
obstacle: 34 122
obstacle: 35 35
obstacle: 35 40
obstacle: 35 50
obstacle: 35 66
obstacle: 35 94
obstacle: 35 101
obstacle: 35 112
obstacle: 35 117
obstacle: 36 36
obstacle: 36 40
obstacle: 36 50
obstacle: 36 83
obstacle: 36 93
obstacle: 36 122
obstacle: 37 11
obstacle: 37 13
obstacle: 37 14
obstacle: 37 17
obstacle: 37 18
obstacle: 37 21
obstacle: 37 36
obstacle: 37 40
obstacle: 37 50
obstacle: 37 52
obstacle: 37 66
obstacle: 37 95
obstacle: 37 104
obstacle: 37 122
obstacle: 38 35
obstacle: 38 36
obstacle: 38 40
obstacle: 38 50
obstacle: 38 66
obstacle: 38 101
obstacle: 38 104
obstacle: 38 112
obstacle: 38 117
obstacle: 38 122
obstacle: 39 12
obstacle: 39 21
obstacle: 39 36
obstacle: 39 104
obstacle: 40 7
obstacle: 40 12
obstacle: 40 21
obstacle: 40 36
obstacle: 40 40
obstacle: 40 50
obstacle: 40 66
obstacle: 41 36
obstacle: 41 40
obstacle: 41 50
obstacle: 41 65
obstacle: 41 71
obstacle: 41 74
obstacle: 41 75
obstacle: 41 76
obstacle: 41 78
obstacle: 41 79
obstacle: 41 81
obstacle: 41 82
obstacle: 41 83
obstacle: 41 95
obstacle: 41 101
obstacle: 42 7
obstacle: 42 12
obstacle: 42 21
obstacle: 42 40
obstacle: 42 61
obstacle: 42 101
obstacle: 42 104
obstacle: 42 112
obstacle: 42 117
obstacle: 42 122
obstacle: 43 21
obstacle: 43 38
obstacle: 43 39
obstacle: 43 40
obstacle: 43 46
obstacle: 43 48
obstacle: 43 59
obstacle: 43 65
obstacle: 43 101
obstacle: 43 112
obstacle: 43 117
obstacle: 43 122
obstacle: 44 7
obstacle: 44 40
obstacle: 44 75
obstacle: 44 83
obstacle: 44 101
obstacle: 44 112
obstacle: 45 7
obstacle: 45 19
obstacle: 45 20
obstacle: 45 21
obstacle: 45 22
obstacle: 45 23
obstacle: 45 24
obstacle: 45 25
obstacle: 45 36
obstacle: 45 40
obstacle: 45 50
obstacle: 45 66
obstacle: 45 70
obstacle: 45 83
obstacle: 45 88
obstacle: 45 101
obstacle: 45 112
obstacle: 45 117
obstacle: 45 122
obstacle: 46 34
obstacle: 46 39
obstacle: 46 40
obstacle: 46 42
obstacle: 46 46
obstacle: 46 48
obstacle: 46 59
obstacle: 46 61
obstacle: 46 64
obstacle: 46 75
obstacle: 46 77
obstacle: 46 78
obstacle: 46 79
obstacle: 46 81
obstacle: 46 82
obstacle: 46 83
obstacle: 46 84
obstacle: 46 85
obstacle: 46 87
obstacle: 46 88
obstacle: 46 89
obstacle: 46 91
obstacle: 46 94
obstacle: 46 95
obstacle: 46 97
obstacle: 46 99
obstacle: 46 100
obstacle: 46 101
obstacle: 46 102
obstacle: 46 104
obstacle: 46 105
obstacle: 46 112
obstacle: 46 122
obstacle: 47 40
obstacle: 47 61
obstacle: 47 66
obstacle: 47 70
obstacle: 47 77
obstacle: 47 82
obstacle: 47 97
obstacle: 47 101
obstacle: 47 104
obstacle: 47 105
obstacle: 48 7
obstacle: 48 12
obstacle: 48 19
obstacle: 48 21
obstacle: 48 31
obstacle: 48 36
obstacle: 48 38
obstacle: 48 40
obstacle: 48 50
obstacle: 48 77
obstacle: 48 105
obstacle: 49 25
obstacle: 49 36
obstacle: 49 59
obstacle: 49 64
obstacle: 49 70
obstacle: 49 71
obstacle: 49 75
obstacle: 49 76
obstacle: 49 79
obstacle: 49 81
obstacle: 49 82
obstacle: 49 84
obstacle: 49 87
obstacle: 49 89
obstacle: 49 91
obstacle: 49 94
obstacle: 49 95
obstacle: 49 97
obstacle: 49 99
obstacle: 49 100
obstacle: 49 102
obstacle: 49 104
obstacle: 50 19
obstacle: 50 21
obstacle: 50 25
obstacle: 50 36
obstacle: 50 40
obstacle: 50 66
obstacle: 50 77
obstacle: 51 7
obstacle: 51 101
obstacle: 51 105
obstacle: 51 108
obstacle: 51 117
obstacle: 51 122
obstacle: 52 7
obstacle: 52 12
obstacle: 52 19
obstacle: 52 21
obstacle: 52 25
obstacle: 52 36
obstacle: 52 40
obstacle: 52 50
obstacle: 52 64
obstacle: 52 66
obstacle: 52 70
obstacle: 52 75
obstacle: 52 77
obstacle: 52 83
obstacle: 52 88
obstacle: 52 98
obstacle: 52 101
obstacle: 52 105
obstacle: 52 108
obstacle: 52 117
obstacle: 53 19
obstacle: 53 21
obstacle: 53 25
obstacle: 53 31
obstacle: 53 36
obstacle: 53 40
obstacle: 53 50
obstacle: 53 64
obstacle: 53 66
obstacle: 53 70
obstacle: 53 77
obstacle: 53 83
obstacle: 53 101
obstacle: 53 105
obstacle: 54 7
obstacle: 54 12
obstacle: 54 19
obstacle: 54 21
obstacle: 54 25
obstacle: 54 36
obstacle: 54 40
obstacle: 54 64
obstacle: 54 66
obstacle: 54 70
obstacle: 54 71
obstacle: 54 75
obstacle: 54 76
obstacle: 54 81
obstacle: 54 82
obstacle: 54 83
obstacle: 54 84
obstacle: 54 87
obstacle: 54 88
obstacle: 54 89
obstacle: 54 91
obstacle: 54 94
obstacle: 54 97
obstacle: 54 98
obstacle: 54 99
obstacle: 54 100
obstacle: 54 101
obstacle: 54 102
obstacle: 54 105
obstacle: 54 108
obstacle: 54 117
obstacle: 54 122
obstacle: 55 7
obstacle: 55 12
obstacle: 55 19
obstacle: 55 21
obstacle: 55 25
obstacle: 55 36
obstacle: 55 42
obstacle: 55 43
obstacle: 55 45
obstacle: 55 47
obstacle: 55 50
obstacle: 55 51
obstacle: 55 53
obstacle: 55 58
obstacle: 55 62
obstacle: 55 65
obstacle: 55 66
obstacle: 55 70
obstacle: 55 71
obstacle: 55 72
obstacle: 55 80
obstacle: 55 85
obstacle: 55 93
obstacle: 55 94
obstacle: 55 97
obstacle: 55 98
obstacle: 55 101
obstacle: 55 102
obstacle: 55 105
obstacle: 56 7
obstacle: 56 25
obstacle: 56 36
obstacle: 56 50
obstacle: 56 64
obstacle: 56 66
obstacle: 56 70
obstacle: 56 77
obstacle: 56 83
obstacle: 56 102
obstacle: 56 105
obstacle: 57 7
obstacle: 57 25
obstacle: 57 36
obstacle: 57 66
obstacle: 57 102
obstacle: 57 105
obstacle: 57 122
obstacle: 58 7
obstacle: 58 12
obstacle: 58 19
obstacle: 58 64
obstacle: 58 66
obstacle: 58 70
obstacle: 59 7
obstacle: 59 19
obstacle: 59 25
obstacle: 59 29
obstacle: 59 30
obstacle: 59 32
obstacle: 59 34
obstacle: 59 37
obstacle: 59 42
obstacle: 59 43
obstacle: 59 45
obstacle: 59 46
obstacle: 59 48
obstacle: 59 50
obstacle: 59 53
obstacle: 59 55
obstacle: 59 58
obstacle: 59 59
obstacle: 59 60
obstacle: 59 62
obstacle: 59 63
obstacle: 59 64
obstacle: 59 66
obstacle: 59 70
obstacle: 59 77
obstacle: 59 83
obstacle: 59 102
obstacle: 59 105
obstacle: 59 108
obstacle: 60 7
obstacle: 60 12
obstacle: 60 19
obstacle: 60 25
obstacle: 60 31
obstacle: 60 36
obstacle: 60 40
obstacle: 60 44
obstacle: 60 47
obstacle: 60 50
obstacle: 60 51
obstacle: 60 61
obstacle: 60 66
obstacle: 60 77
obstacle: 60 102
obstacle: 60 105
obstacle: 60 122
obstacle: 61 36
obstacle: 61 50
obstacle: 61 77
obstacle: 61 102
obstacle: 61 105
obstacle: 61 108
obstacle: 61 117
obstacle: 61 122
obstacle: 62 7
obstacle: 62 12
obstacle: 62 19
obstacle: 62 25
obstacle: 62 31
obstacle: 62 35
obstacle: 62 36
obstacle: 62 40
obstacle: 62 44
obstacle: 62 47
obstacle: 62 51
obstacle: 62 61
obstacle: 62 77
obstacle: 62 95
obstacle: 62 105
obstacle: 62 122
obstacle: 63 7
obstacle: 63 12
obstacle: 63 19
obstacle: 63 25
obstacle: 63 43
obstacle: 63 45
obstacle: 63 51
obstacle: 63 55
obstacle: 63 62
obstacle: 63 63
obstacle: 63 65
obstacle: 63 66
obstacle: 63 67
obstacle: 63 70
obstacle: 63 71
obstacle: 63 72
obstacle: 63 83
obstacle: 63 102
obstacle: 63 105
obstacle: 63 108
obstacle: 63 122
obstacle: 64 25
obstacle: 64 36
obstacle: 64 50
obstacle: 64 61
obstacle: 64 66
obstacle: 64 70
obstacle: 64 77
obstacle: 64 83
obstacle: 64 102
obstacle: 64 105
obstacle: 64 108
obstacle: 64 122
obstacle: 65 7
obstacle: 65 25
obstacle: 65 36
obstacle: 65 66
obstacle: 65 83
obstacle: 65 88
obstacle: 65 102
obstacle: 65 105
obstacle: 65 108
obstacle: 66 19
obstacle: 66 31
obstacle: 66 40
obstacle: 66 44
obstacle: 66 47
obstacle: 66 51
obstacle: 66 61
obstacle: 66 77
obstacle: 66 95
obstacle: 66 105
obstacle: 66 122
obstacle: 67 7
obstacle: 67 12
obstacle: 67 19
obstacle: 67 25
obstacle: 67 31
obstacle: 67 36
obstacle: 67 40
obstacle: 67 47
obstacle: 67 51
obstacle: 67 52
obstacle: 67 54
obstacle: 67 69
obstacle: 67 77
obstacle: 67 81
obstacle: 67 89
obstacle: 67 94
obstacle: 67 99
obstacle: 68 7
obstacle: 68 12
obstacle: 68 19
obstacle: 68 25
obstacle: 68 31
obstacle: 68 36
obstacle: 68 40
obstacle: 68 50
obstacle: 68 66
obstacle: 68 70
obstacle: 68 83
obstacle: 68 102
obstacle: 68 105
obstacle: 69 50
obstacle: 69 66
obstacle: 69 70
obstacle: 69 105
obstacle: 70 27
obstacle: 70 28
obstacle: 70 30
obstacle: 70 31
obstacle: 70 33
obstacle: 70 34
obstacle: 70 36
obstacle: 70 37
obstacle: 70 38
obstacle: 70 39
obstacle: 70 40
obstacle: 70 41
obstacle: 70 42
obstacle: 70 44
obstacle: 70 47
obstacle: 70 50
obstacle: 70 51
obstacle: 70 52
obstacle: 70 54
obstacle: 70 58
obstacle: 70 59
obstacle: 70 61
obstacle: 70 62
obstacle: 70 64
obstacle: 70 66
obstacle: 70 67
obstacle: 70 69
obstacle: 70 70
obstacle: 70 71
obstacle: 70 73
obstacle: 70 74
obstacle: 70 75
obstacle: 70 76
obstacle: 70 77
obstacle: 70 78
obstacle: 70 79
obstacle: 70 105
obstacle: 71 12
obstacle: 71 19
obstacle: 71 25
obstacle: 71 27
obstacle: 71 31
obstacle: 71 36
obstacle: 71 50
obstacle: 71 61
obstacle: 71 66
obstacle: 71 70
obstacle: 71 77
obstacle: 71 80
obstacle: 71 105
obstacle: 71 122
obstacle: 72 12
obstacle: 72 19
obstacle: 72 27
obstacle: 72 31
obstacle: 72 40
obstacle: 72 77
obstacle: 72 80
obstacle: 72 100
obstacle: 72 102
obstacle: 72 105
obstacle: 72 108
obstacle: 72 117
obstacle: 73 27
obstacle: 73 31
obstacle: 73 66
obstacle: 73 70
obstacle: 73 76
obstacle: 73 77
obstacle: 73 78
obstacle: 73 82
obstacle: 73 84
obstacle: 73 85
obstacle: 73 89
obstacle: 73 93
obstacle: 73 94
obstacle: 73 99
obstacle: 73 100
obstacle: 73 101
obstacle: 73 102
obstacle: 73 103
obstacle: 73 105
obstacle: 73 107
obstacle: 73 109
obstacle: 74 7
obstacle: 74 12
obstacle: 74 19
obstacle: 74 36
obstacle: 74 40
obstacle: 74 42
obstacle: 74 43
obstacle: 74 45
obstacle: 74 46
obstacle: 74 48
obstacle: 74 53
obstacle: 74 55
obstacle: 74 56
obstacle: 74 58
obstacle: 74 59
obstacle: 74 60
obstacle: 74 61
obstacle: 74 62
obstacle: 74 63
obstacle: 74 65
obstacle: 74 66
obstacle: 74 67
obstacle: 74 68
obstacle: 74 71
obstacle: 74 72
obstacle: 74 73
obstacle: 74 74
obstacle: 74 75
obstacle: 74 76
obstacle: 74 77
obstacle: 74 80
obstacle: 74 81
obstacle: 74 82
obstacle: 74 84
obstacle: 74 86
obstacle: 74 89
obstacle: 74 90
obstacle: 74 91
obstacle: 74 92
obstacle: 74 93
obstacle: 74 94
obstacle: 74 95
obstacle: 74 96
obstacle: 74 97
obstacle: 74 101
obstacle: 74 103
obstacle: 74 104
obstacle: 75 25
obstacle: 75 27
obstacle: 75 31
obstacle: 75 36
obstacle: 75 47
obstacle: 75 51
obstacle: 75 66
obstacle: 75 75
obstacle: 75 77
obstacle: 75 80
obstacle: 76 9
obstacle: 76 13
obstacle: 76 19
obstacle: 76 20
obstacle: 76 22
obstacle: 76 25
obstacle: 76 51
obstacle: 76 53
obstacle: 76 55
obstacle: 76 56
obstacle: 76 58
obstacle: 76 59
obstacle: 76 60
obstacle: 76 62
obstacle: 76 63
obstacle: 76 65
obstacle: 76 66
obstacle: 76 67
obstacle: 76 68
obstacle: 76 70
obstacle: 76 71
obstacle: 76 72
obstacle: 76 73
obstacle: 76 80
obstacle: 76 81
obstacle: 76 83
obstacle: 77 25
obstacle: 77 36
obstacle: 77 50
obstacle: 77 66
obstacle: 77 80
obstacle: 78 3
obstacle: 78 7
obstacle: 78 12
obstacle: 78 19
obstacle: 78 22
obstacle: 78 25
obstacle: 78 27
obstacle: 78 36
obstacle: 78 50
obstacle: 78 66
obstacle: 78 70
obstacle: 78 75
obstacle: 78 80
obstacle: 78 81
obstacle: 78 83
obstacle: 78 85
obstacle: 78 89
obstacle: 78 91
obstacle: 78 92
obstacle: 78 93
obstacle: 78 94
obstacle: 78 95
obstacle: 78 97
obstacle: 78 98
obstacle: 78 101
obstacle: 78 102
obstacle: 78 103
obstacle: 78 104
obstacle: 78 108
obstacle: 78 111
obstacle: 78 112
obstacle: 78 114
obstacle: 78 117
obstacle: 78 122
obstacle: 79 3
obstacle: 79 7
obstacle: 79 10
obstacle: 79 20
obstacle: 79 22
obstacle: 79 27
obstacle: 79 31
obstacle: 79 77
obstacle: 79 80
obstacle: 79 109
obstacle: 80 19
obstacle: 80 27
obstacle: 80 31
obstacle: 80 36
obstacle: 80 44
obstacle: 80 50
obstacle: 80 51
obstacle: 80 52
obstacle: 80 54
obstacle: 80 61
obstacle: 80 64
obstacle: 80 66
obstacle: 80 69
obstacle: 80 71
obstacle: 80 77
obstacle: 80 82
obstacle: 80 86
obstacle: 80 89
obstacle: 80 94
obstacle: 80 99
obstacle: 80 101
obstacle: 80 103
obstacle: 80 110
obstacle: 80 113
obstacle: 80 114
obstacle: 80 116
obstacle: 80 118
obstacle: 80 119
obstacle: 80 120
obstacle: 81 3
obstacle: 81 7
obstacle: 81 20
obstacle: 81 25
obstacle: 81 27
obstacle: 81 28
obstacle: 81 30
obstacle: 81 32
obstacle: 81 33
obstacle: 81 34
obstacle: 81 38
obstacle: 81 42
obstacle: 81 43
obstacle: 81 45
obstacle: 81 46
obstacle: 81 47
obstacle: 81 48
obstacle: 81 109
obstacle: 81 120
obstacle: 82 3
obstacle: 82 7
obstacle: 82 16
obstacle: 82 18
obstacle: 82 19
obstacle: 82 20
obstacle: 82 21
obstacle: 82 22
obstacle: 82 24
obstacle: 82 25
obstacle: 82 26
obstacle: 82 28
obstacle: 82 29
obstacle: 82 30
obstacle: 82 32
obstacle: 82 33
obstacle: 82 34
obstacle: 82 35
obstacle: 82 36
obstacle: 82 37
obstacle: 82 38
obstacle: 82 40
obstacle: 82 42
obstacle: 82 44
obstacle: 82 51
obstacle: 82 61
obstacle: 82 64
obstacle: 82 66
obstacle: 82 77
obstacle: 82 95
obstacle: 82 102
obstacle: 82 103
obstacle: 82 108
obstacle: 82 109
obstacle: 82 120
obstacle: 83 3
obstacle: 83 7
obstacle: 83 12
obstacle: 83 16
obstacle: 83 22
obstacle: 83 25
obstacle: 83 27
obstacle: 83 29
obstacle: 83 31
obstacle: 83 36
obstacle: 83 42
obstacle: 83 66
obstacle: 83 80
obstacle: 83 102
obstacle: 83 103
obstacle: 83 109
obstacle: 83 120
obstacle: 84 3
obstacle: 84 7
obstacle: 84 12
obstacle: 84 16
obstacle: 84 22
obstacle: 84 25
obstacle: 84 27
obstacle: 84 31
obstacle: 84 36
obstacle: 84 42
obstacle: 84 51
obstacle: 84 53
obstacle: 84 55
obstacle: 84 56
obstacle: 84 58
obstacle: 84 59
obstacle: 84 60
obstacle: 84 65
obstacle: 84 66
obstacle: 84 67
obstacle: 84 70
obstacle: 84 72
obstacle: 84 80
obstacle: 84 81
obstacle: 84 88
obstacle: 84 94
obstacle: 84 95
obstacle: 84 97
obstacle: 84 98
obstacle: 84 101
obstacle: 84 110
obstacle: 85 3
obstacle: 85 7
obstacle: 85 12
obstacle: 85 16
obstacle: 85 22
obstacle: 85 25
obstacle: 85 27
obstacle: 85 29
obstacle: 85 36
obstacle: 85 42
obstacle: 85 66
obstacle: 85 77
obstacle: 85 80
obstacle: 85 102
obstacle: 85 103
obstacle: 85 109
obstacle: 85 110
obstacle: 85 120
obstacle: 86 3
obstacle: 86 7
obstacle: 86 16
obstacle: 86 22
obstacle: 86 25
obstacle: 86 29
obstacle: 86 36
obstacle: 86 47
obstacle: 86 49
obstacle: 86 50
obstacle: 86 58
obstacle: 86 62
obstacle: 86 66
obstacle: 86 69
obstacle: 86 71
obstacle: 86 73
obstacle: 86 76
obstacle: 86 77
obstacle: 86 78
obstacle: 86 79
obstacle: 86 82
obstacle: 86 85
obstacle: 86 89
obstacle: 86 90
obstacle: 86 93
obstacle: 86 94
obstacle: 86 99
obstacle: 86 101
obstacle: 86 104
obstacle: 86 106
obstacle: 86 107
obstacle: 86 108
obstacle: 86 109
obstacle: 86 110
obstacle: 87 3
obstacle: 87 7
obstacle: 87 12
obstacle: 87 16
obstacle: 87 22
obstacle: 87 25
obstacle: 87 27
obstacle: 87 28
obstacle: 87 29
obstacle: 87 30
obstacle: 87 31
obstacle: 87 32
obstacle: 87 33
obstacle: 87 34
obstacle: 87 35
obstacle: 87 36
obstacle: 87 38
obstacle: 87 40
obstacle: 87 41
obstacle: 87 42
obstacle: 87 43
obstacle: 87 45
obstacle: 87 46
obstacle: 87 47
obstacle: 87 48
obstacle: 87 49
obstacle: 87 50
obstacle: 87 51
obstacle: 87 52
obstacle: 87 53
obstacle: 87 55
obstacle: 87 56
obstacle: 87 58
obstacle: 87 59
obstacle: 87 60
obstacle: 87 61
obstacle: 87 63
obstacle: 87 64
obstacle: 87 65
obstacle: 87 66
obstacle: 87 80
obstacle: 87 109
obstacle: 87 112
obstacle: 88 3
obstacle: 88 7
obstacle: 88 16
obstacle: 88 42
obstacle: 88 80
obstacle: 88 81
obstacle: 88 84
obstacle: 88 91
obstacle: 88 92
obstacle: 88 94
obstacle: 88 97
obstacle: 88 101
obstacle: 88 104
obstacle: 88 107
obstacle: 88 108
obstacle: 88 111
obstacle: 88 114
obstacle: 89 22
obstacle: 89 25
obstacle: 89 29
obstacle: 89 36
obstacle: 89 42
obstacle: 89 52
obstacle: 89 54
obstacle: 89 61
obstacle: 89 64
obstacle: 89 70
obstacle: 89 80
obstacle: 89 95
obstacle: 90 3
obstacle: 90 7
obstacle: 90 12
obstacle: 90 16
obstacle: 90 22
obstacle: 90 25
obstacle: 90 29
obstacle: 90 31
obstacle: 90 36
obstacle: 90 41
obstacle: 90 42
obstacle: 90 64
obstacle: 90 66
obstacle: 90 96
obstacle: 90 102
obstacle: 90 103
obstacle: 90 109
obstacle: 90 110
obstacle: 90 112
obstacle: 91 3
obstacle: 91 7
obstacle: 91 22
obstacle: 91 42
obstacle: 91 70
obstacle: 91 80
obstacle: 91 88
obstacle: 91 100
obstacle: 91 102
obstacle: 91 103
obstacle: 92 29
obstacle: 92 32
obstacle: 92 42
obstacle: 92 43
obstacle: 92 48
obstacle: 92 50
obstacle: 92 51
obstacle: 92 53
obstacle: 92 55
obstacle: 92 58
obstacle: 92 59
obstacle: 92 60
obstacle: 92 63
obstacle: 92 66
obstacle: 92 67
obstacle: 92 80
obstacle: 92 81
obstacle: 92 94
obstacle: 92 95
obstacle: 92 96
obstacle: 92 98
obstacle: 92 101
obstacle: 92 102
obstacle: 92 103
obstacle: 92 109
obstacle: 92 110
obstacle: 92 112
obstacle: 93 3
obstacle: 93 4
obstacle: 93 6
obstacle: 93 9
obstacle: 93 10
obstacle: 93 11
obstacle: 93 12
obstacle: 93 13
obstacle: 93 14
obstacle: 93 15
obstacle: 93 16
obstacle: 93 19
obstacle: 93 20
obstacle: 93 21
obstacle: 93 24
obstacle: 93 25
obstacle: 93 26
obstacle: 93 28
obstacle: 93 29
obstacle: 93 30
obstacle: 93 31
obstacle: 93 32
obstacle: 93 34
obstacle: 93 35
obstacle: 93 36
obstacle: 93 37
obstacle: 93 38
obstacle: 93 40
obstacle: 93 42
obstacle: 93 80
obstacle: 93 109
obstacle: 93 112
obstacle: 94 22
obstacle: 94 31
obstacle: 94 61
obstacle: 94 64
obstacle: 94 102
obstacle: 95 7
obstacle: 95 16
obstacle: 95 22
obstacle: 95 25
obstacle: 95 36
obstacle: 95 80
obstacle: 95 110
obstacle: 96 7
obstacle: 96 9
obstacle: 96 11
obstacle: 96 13
obstacle: 96 19
obstacle: 96 20
obstacle: 96 22
obstacle: 96 24
obstacle: 96 36
obstacle: 96 70
obstacle: 97 2
obstacle: 97 6
obstacle: 97 9
obstacle: 97 12
obstacle: 97 13
obstacle: 97 15
obstacle: 97 16
obstacle: 97 18
obstacle: 97 19
obstacle: 97 22
obstacle: 97 23
obstacle: 97 36
obstacle: 97 41
obstacle: 97 100
obstacle: 97 102
obstacle: 97 109
obstacle: 97 110
obstacle: 97 112
obstacle: 98 2
obstacle: 98 12
obstacle: 98 16
obstacle: 98 25
obstacle: 98 30
obstacle: 98 33
obstacle: 98 37
obstacle: 98 40
obstacle: 98 47
obstacle: 98 49
obstacle: 98 50
obstacle: 98 53
obstacle: 98 58
obstacle: 98 66
obstacle: 98 69
obstacle: 98 71
obstacle: 98 76
obstacle: 98 78
obstacle: 98 79
obstacle: 98 80
obstacle: 98 82
obstacle: 98 83
obstacle: 98 87
obstacle: 98 89
obstacle: 99 2
obstacle: 99 12
obstacle: 99 31
obstacle: 99 32
obstacle: 99 34
obstacle: 99 42
obstacle: 99 43
obstacle: 99 45
obstacle: 99 46
obstacle: 99 48
obstacle: 99 50
obstacle: 99 52
obstacle: 99 53
obstacle: 99 55
obstacle: 99 58
obstacle: 99 60
obstacle: 99 63
obstacle: 99 64
obstacle: 99 66
obstacle: 99 67
obstacle: 99 74
obstacle: 99 78
obstacle: 99 80
obstacle: 99 85
obstacle: 99 91
obstacle: 99 94
obstacle: 99 96
obstacle: 99 98
obstacle: 99 101
obstacle: 99 104
obstacle: 99 108
obstacle: 99 109
obstacle: 99 110
obstacle: 99 112
obstacle: 100 2
obstacle: 100 16
obstacle: 100 26
obstacle: 100 28
obstacle: 100 30
obstacle: 100 31
obstacle: 100 32
obstacle: 100 33
obstacle: 100 34
obstacle: 100 35
obstacle: 100 36
obstacle: 100 80
obstacle: 100 89
obstacle: 100 112
obstacle: 101 2
obstacle: 101 16
obstacle: 101 22
obstacle: 101 23
obstacle: 101 41
obstacle: 101 44
obstacle: 101 61
obstacle: 101 64
obstacle: 101 80
obstacle: 101 95
obstacle: 101 110
obstacle: 102 2
obstacle: 102 48
obstacle: 102 53
obstacle: 102 55
obstacle: 102 64
obstacle: 102 66
obstacle: 102 67
obstacle: 102 74
obstacle: 102 78
obstacle: 102 80
obstacle: 102 94
obstacle: 102 96
obstacle: 103 2
obstacle: 103 3
obstacle: 103 6
obstacle: 103 7
obstacle: 103 8
obstacle: 103 9
obstacle: 103 10
obstacle: 103 11
obstacle: 103 12
obstacle: 103 13
obstacle: 103 14
obstacle: 103 15
obstacle: 103 19
obstacle: 103 20
obstacle: 103 21
obstacle: 103 22
obstacle: 103 23
obstacle: 103 29
obstacle: 103 41
obstacle: 103 70
obstacle: 103 80
obstacle: 103 89
obstacle: 103 95
obstacle: 103 102
obstacle: 103 110
obstacle: 103 112
obstacle: 104 23
obstacle: 104 41
obstacle: 104 61
obstacle: 104 64
obstacle: 104 70
obstacle: 104 80
obstacle: 104 110
obstacle: 104 112
obstacle: 105 16
obstacle: 105 23
obstacle: 105 66
obstacle: 105 69
obstacle: 105 71
obstacle: 105 89
obstacle: 105 95
obstacle: 105 97
obstacle: 105 101
obstacle: 105 102
obstacle: 105 108
obstacle: 105 110
obstacle: 105 112
obstacle: 105 119
obstacle: 106 16
obstacle: 106 23
obstacle: 107 30
obstacle: 107 33
obstacle: 107 43
obstacle: 107 48
obstacle: 107 53
obstacle: 107 55
obstacle: 107 58
obstacle: 107 64
obstacle: 107 66
obstacle: 107 80
obstacle: 107 89
obstacle: 108 19
obstacle: 108 23
obstacle: 108 28
obstacle: 108 33
obstacle: 108 61
obstacle: 108 64
obstacle: 108 110
obstacle: 108 112
obstacle: 109 23
obstacle: 109 33
obstacle: 109 64
obstacle: 109 66
obstacle: 109 80
obstacle: 109 95
obstacle: 110 9
obstacle: 110 12
obstacle: 110 13
obstacle: 110 23
obstacle: 110 24
obstacle: 110 26
obstacle: 110 29
obstacle: 110 30
obstacle: 110 33
obstacle: 110 34
obstacle: 110 36
obstacle: 110 37
obstacle: 110 39
obstacle: 110 41
obstacle: 110 44
obstacle: 110 47
obstacle: 110 50
obstacle: 110 51
obstacle: 110 59
obstacle: 110 62
obstacle: 110 66
obstacle: 110 67
obstacle: 110 80
obstacle: 110 89
obstacle: 110 100
obstacle: 110 102
obstacle: 110 112
obstacle: 110 119
obstacle: 111 16
obstacle: 111 89
obstacle: 111 102
obstacle: 111 112
obstacle: 112 16
obstacle: 112 41
obstacle: 112 64
obstacle: 112 66
obstacle: 112 70
obstacle: 112 74
obstacle: 112 78
obstacle: 112 80
obstacle: 112 81
obstacle: 112 88
obstacle: 112 91
obstacle: 112 94
obstacle: 112 98
obstacle: 112 101
obstacle: 112 110
obstacle: 113 23
obstacle: 113 33
obstacle: 113 66
obstacle: 113 67
obstacle: 113 80
obstacle: 113 89
obstacle: 113 110
obstacle: 113 112
obstacle: 114 23
obstacle: 114 89
obstacle: 114 112
obstacle: 115 1
obstacle: 115 3
obstacle: 115 6
obstacle: 115 7
obstacle: 115 9
obstacle: 115 12
obstacle: 115 13
obstacle: 115 14
obstacle: 115 15
obstacle: 115 17
obstacle: 115 19
obstacle: 115 20
obstacle: 115 21
obstacle: 115 22
obstacle: 115 67
obstacle: 115 80
obstacle: 115 110
obstacle: 115 111
obstacle: 115 112
obstacle: 115 119
obstacle: 117 16
obstacle: 117 18
obstacle: 117 56
obstacle: 117 58
obstacle: 117 59
obstacle: 117 60
obstacle: 117 63
obstacle: 117 66
obstacle: 117 70
obstacle: 117 74
obstacle: 117 78
obstacle: 117 80
obstacle: 117 81
obstacle: 117 87
obstacle: 117 88
obstacle: 118 61
obstacle: 118 67
obstacle: 118 80
obstacle: 118 86
obstacle: 119 65
obstacle: 119 66
obstacle: 119 70
obstacle: 119 74
obstacle: 119 78
obstacle: 119 80
obstacle: 119 81
obstacle: 119 88
obstacle: 119 98
obstacle: 119 101
obstacle: 119 103
obstacle: 119 104
obstacle: 120 19
obstacle: 120 24
obstacle: 120 26
obstacle: 120 31
obstacle: 120 32
obstacle: 120 35
obstacle: 120 40
obstacle: 120 42
obstacle: 120 48
obstacle: 120 49
obstacle: 120 50
obstacle: 120 56
obstacle: 120 58
obstacle: 120 60
obstacle: 120 61
obstacle: 120 62
obstacle: 120 63
obstacle: 120 65
obstacle: 120 66
obstacle: 120 70
obstacle: 120 74
obstacle: 120 78
obstacle: 120 79
obstacle: 120 80
obstacle: 120 86
obstacle: 121 16
obstacle: 121 33
obstacle: 121 41
obstacle: 121 67
obstacle: 122 17
obstacle: 122 19
obstacle: 122 24
obstacle: 122 26
obstacle: 122 30
obstacle: 122 31
obstacle: 122 32
obstacle: 122 67
obstacle: 122 86
obstacle: 123 67
obstacle: 123 86
obstacle: 124 41
obstacle: 124 67
obstacle: 125 42
obstacle: 125 48
obstacle: 125 50
obstacle: 125 56
obstacle: 125 58
obstacle: 125 60
obstacle: 125 62
obstacle: 125 63
obstacle: 125 64
obstacle: 125 65
obstacle: 125 66
obstacle: 125 70
obstacle: 125 74
obstacle: 125 80
obstacle: 125 81
obstacle: 125 82
obstacle: 125 84
obstacle: 126 36
obstacle: 126 67
obstacle: 127 36
obstacle: 128 33
obstacle: 128 35
obstacle: 128 40
obstacle: 128 41
obstacle: 128 44
obstacle: 128 48
obstacle: 128 49
obstacle: 128 50
obstacle: 128 52
obstacle: 128 56
obstacle: 128 58
obstacle: 128 62
obstacle: 128 63
obstacle: 128 64
obstacle: 128 65
obstacle: 128 66
obstacle: 129 36
""".trimIndent().split("\n").map { line ->
  val y = line.split(" ")[1].toInt()
  val x = line.split(" ")[2].toInt()
  Pos(y, x)
}